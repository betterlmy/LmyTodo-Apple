# ç™»å½•é”™è¯¯å¤„ç†æµ‹è¯•æŒ‡å—

## ğŸ” é”™è¯¯å¤„ç†æ”¹è¿›

### åŸå§‹é—®é¢˜
ä¹‹å‰çš„å®ç°åªå¤„ç†ç½‘ç»œå±‚é”™è¯¯ï¼Œæ²¡æœ‰æ­£ç¡®å¤„ç†HTTPçŠ¶æ€ç å’Œåç«¯è¿”å›çš„å…·ä½“é”™è¯¯ä¿¡æ¯ã€‚

### æ”¹è¿›åçš„é”™è¯¯å¤„ç†

#### 1. HTTPçŠ¶æ€ç å¤„ç†
```swift
switch httpResponse.statusCode {
case 200...299: // æˆåŠŸ
case 401:       // è®¤è¯å¤±è´¥
case 400:       // è¯·æ±‚é”™è¯¯  
case 409:       // å†²çªï¼ˆç”¨æˆ·åå·²å­˜åœ¨ï¼‰
case 500...599: // æœåŠ¡å™¨é”™è¯¯
default:        // å…¶ä»–é”™è¯¯
}
```

#### 2. é”™è¯¯ä¿¡æ¯è§£æ
```swift
// è§£æåç«¯è¿”å›çš„é”™è¯¯JSON
if let errorData = try? JSONDecoder().decode(ErrorResponse.self, from: data) {
    throw NetworkError.authenticationFailed(errorData.error)
}
```

#### 3. å…·ä½“é”™è¯¯ç±»å‹
```swift
enum NetworkError: Error {
    case authenticationFailed(String) // "Invalid credentials"
    case badRequest(String)           // "Missing required fields"
    case conflict(String)             // "Username already exists"
    case serverError(String)          // "Internal server error"
}
```

## ğŸ§ª æµ‹è¯•åœºæ™¯

### 1. ç™»å½•å¤±è´¥æµ‹è¯•

#### åœºæ™¯1: ç”¨æˆ·åä¸å­˜åœ¨
- **è¾“å…¥**: `username: "nonexistent", password: "anything"`
- **åç«¯å“åº”**: `401 {"error": "Invalid credentials"}`
- **Appæ˜¾ç¤º**: "ç™»å½•å¤±è´¥: Invalid credentials"

#### åœºæ™¯2: å¯†ç é”™è¯¯
- **è¾“å…¥**: `username: "validuser", password: "wrongpassword"`
- **åç«¯å“åº”**: `401 {"error": "Invalid credentials"}`
- **Appæ˜¾ç¤º**: "ç™»å½•å¤±è´¥: Invalid credentials"

#### åœºæ™¯3: ç¼ºå°‘å¿…å¡«å­—æ®µ
- **è¾“å…¥**: `username: "", password: "123456"`
- **åç«¯å“åº”**: `400 {"error": "username is required"}`
- **Appæ˜¾ç¤º**: "è¯·æ±‚é”™è¯¯: username is required"

### 2. æ³¨å†Œå¤±è´¥æµ‹è¯•

#### åœºæ™¯1: ç”¨æˆ·åå·²å­˜åœ¨
- **è¾“å…¥**: `username: "existinguser", email: "test@test.com", password: "123456"`
- **åç«¯å“åº”**: `409 {"error": "Username already exists"}`
- **Appæ˜¾ç¤º**: "å†²çª: Username already exists"

#### åœºæ™¯2: é‚®ç®±å·²å­˜åœ¨
- **è¾“å…¥**: `username: "newuser", email: "existing@test.com", password: "123456"`
- **åç«¯å“åº”**: `409 {"error": "Email already exists"}`
- **Appæ˜¾ç¤º**: "å†²çª: Email already exists"

### 3. æœåŠ¡å™¨é”™è¯¯æµ‹è¯•

#### åœºæ™¯1: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- **åç«¯å“åº”**: `500 {"error": "Database connection failed"}`
- **Appæ˜¾ç¤º**: "æœåŠ¡å™¨é”™è¯¯: Database connection failed"

#### åœºæ™¯2: æœåŠ¡ä¸å¯ç”¨
- **ç½‘ç»œ**: è¿æ¥è¶…æ—¶æˆ–æœåŠ¡å™¨æ— å“åº”
- **Appæ˜¾ç¤º**: ç½‘ç»œå±‚é”™è¯¯ä¿¡æ¯

## ğŸ“± ç”¨æˆ·ç•Œé¢æ”¹è¿›

### é”™è¯¯æ˜¾ç¤ºä¼˜åŒ–
```swift
// LoginViewä¸­çš„é”™è¯¯å¼¹çª—
.alert("é”™è¯¯", isPresented: $showingAlert) {
    Button("ç¡®å®š") { }
} message: {
    Text(authManager.errorMessage ?? "")
}
```

### åŠ è½½çŠ¶æ€æ˜¾ç¤º
```swift
// æŒ‰é’®åŠ è½½çŠ¶æ€
HStack {
    if authManager.isLoading {
        ProgressView()
    }
    Text(authManager.isLoading ? "å¤„ç†ä¸­..." : "ç™»å½•")
}
```

## ğŸ”§ è°ƒè¯•ä¿¡æ¯

### æ§åˆ¶å°æ—¥å¿—
```
å¼€å§‹ç™»å½•ç”¨æˆ·: testuser
ç™»å½•å¤±è´¥: ç™»å½•å¤±è´¥: Invalid credentials
```

### ç½‘ç»œè¯·æ±‚ç›‘æ§
- å¯ä»¥åœ¨Xcodeçš„Network Debugä¸­æŸ¥çœ‹å®Œæ•´çš„HTTPè¯·æ±‚å’Œå“åº”
- åŒ…æ‹¬çŠ¶æ€ç ã€Headerså’Œå“åº”ä½“

## âœ… éªŒè¯æ­¥éª¤

1. **å¯åŠ¨åç«¯æœåŠ¡** (ç¡®ä¿åœ¨ `:8080` è¿è¡Œ)
2. **æµ‹è¯•æˆåŠŸç™»å½•**:
   - å…ˆæ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ·
   - ç„¶åç”¨æ­£ç¡®çš„å‡­æ®ç™»å½•
3. **æµ‹è¯•å¤±è´¥åœºæ™¯**:
   - é”™è¯¯çš„ç”¨æˆ·å/å¯†ç 
   - é‡å¤æ³¨å†Œç›¸åŒç”¨æˆ·å
   - ç½‘ç»œæ–­å¼€æƒ…å†µ
4. **æ£€æŸ¥é”™è¯¯æç¤º**:
   - ç¡®ä¿é”™è¯¯ä¿¡æ¯æ¸…æ™°æ˜“æ‡‚
   - ä¸­æ–‡æç¤ºå‹å¥½
   - åŠ è½½çŠ¶æ€æ­£ç¡®æ˜¾ç¤º

## ğŸ¯ ä¼˜åŠ¿

1. **è¯¦ç»†é”™è¯¯ä¿¡æ¯**: ç”¨æˆ·çŸ¥é“å…·ä½“æ˜¯ä»€ä¹ˆé—®é¢˜
2. **çŠ¶æ€ç å¤„ç†**: æ­£ç¡®åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯
3. **è°ƒè¯•å‹å¥½**: æ§åˆ¶å°æœ‰è¯¦ç»†æ—¥å¿—
4. **ç”¨æˆ·ä½“éªŒ**: åŠ è½½çŠ¶æ€å’Œå‹å¥½çš„é”™è¯¯æç¤º

è¿™æ ·çš„é”™è¯¯å¤„ç†è®©ç”¨æˆ·èƒ½å¤Ÿæ¸…æ¥šåœ°çŸ¥é“ç™»å½•/æ³¨å†Œå¤±è´¥çš„åŸå› ï¼Œå¤§å¤§æå‡äº†ç”¨æˆ·ä½“éªŒï¼
